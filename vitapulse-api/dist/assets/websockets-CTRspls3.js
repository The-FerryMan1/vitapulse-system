import{k as C,l as L}from"./HeadUlo.vue_vue_type_script_setup_true_lang-DB_JGBnF.js";import{p as y,g as N,q as T,u as U,r as k,c as R,F as G,b as x,h as v,k as S,w as A,m as u,e as H,o as w}from"./index-DmQ4lrpB.js";import{E as M}from"./jspdf.es.min-Hh1kBT-_.js";const W=i=>{const a=new Date(i);return new Date().getFullYear()-a.getFullYear()},B=async(i,a)=>{const e=new M;let l=[],s;try{const{data:n}=await y.get(`/auth/user/${a}`);s=n;const{data:b}=await y.get(`/auth/bp/summary/${a}?filter=${i}`);if(l=b,!l||l.length<0)return null;e.setFontSize(20),e.text("Health Summary Report",20,20);const c=l.reduce((t,o)=>(t.systolic+=o.systolic,t.diastolic+=o.diastolic,t),{systolic:0,diastolic:0}),r=(c.systolic/l.length).toFixed(0),m=(c.diastolic/l.length).toFixed(0),P=(l.reduce((t,o)=>(t.pulse+=o.pulse,t),{pulse:0}).pulse/l.length).toFixed(0),p=l.reduce((t,o)=>o.systolic>t.systolic||o.systolic===t.systolic&&o.diastolic>t.diastolic?o:t),g=l.reduce((t,o)=>o.systolic<t.systolic||o.systolic===t.systolic&&o.diastolic<t.diastolic?o:t),f=l.reduce((t,o)=>o.pulse>t.pulse?o:t),$=l.reduce((t,o)=>o.pulse<t.pulse?o:t),h=l.map(t=>new Date(t.timestamp)).sort((t,o)=>t.getTime()-o.getTime()),D=h[0],_=h[h.length-1],d=t=>t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),F=W(String(s==null?void 0:s.birthday));return e.setFontSize(14),e.text(`Name: ${s.name}`,20,40),e.text(`Age: ${F}`,20,50),e.text(`Gender: ${s.sex}`,20,60),e.text(`Report Period: ${d(D)} to ${d(_)}`,20,70),e.text(`Generated on: ${new Date(Date.now()).toLocaleDateString()}`,20,80),e.text("Metric | Value",20,100),e.text("-----------------------------------",20,110),e.text(`Average BP: ${r}/${m}`,20,120),e.text(`Average Pulse: ${P} bpm`,20,130),e.text(`Highest BP: ${p.systolic} / ${p.diastolic} on ${new Date(p.timestamp).toLocaleString()}`,20,140),e.text(`Lowest BP: ${g.systolic} / ${g.diastolic} on ${new Date(g.timestamp).toLocaleString()}`,20,150),e.text(`Highest Pulse : ${f.pulse} bpm on ${new Date(f.timestamp).toLocaleDateString()}`,20,160),e.text(`Lowest Pulse : ${$.pulse} bpm on ${new Date($.timestamp).toLocaleDateString()}`,20,170),e.text(`Days Monitored : from: ${d(D)} - to: ${d(_)}`,20,180),await y.post("/auth/user/logs",{activity:"Downloaded Weekly summary Health report"},{headers:{"Content-Type":"application/json"}}),e.save(`${s.name}_health_summary_report.pdf`),!0}catch(n){return console.log(n),!1}},Y=N({__name:"SideNav",setup(i){const{auth:a}=T(),e=U(),l=k([[{label:"Dashboard",icon:"i-lucide-layout-dashboard",to:{name:"dashboard"}},{label:"Analytics",icon:"i-lucide-chart-bar",children:[{label:"Anomaly Detection",icon:"i-lucide-chart-line",to:{name:"anomaly"}}]},{label:"Alerts",icon:"i-lucide-siren",to:{name:"alerts"}},{label:"Summary health report",icon:"i-lucide-file-text",children:[{label:"Weekly report",icon:"i-lucide-arrow-down-from-line",onClick:async()=>{if(!a)return;await B("weekly",a==null?void 0:a.id)?e.add({title:"Download success",description:"Weekly health report",color:"success"}):e.add({title:"Download failed",description:"No data to download",color:"warning"})}},{label:"Monthly report",icon:"i-lucide-arrow-down-from-line",onClick:async()=>{if(!a)return;await B("monthly",a==null?void 0:a.id)?e.add({title:"Download success",description:"Monthly health report",color:"success"}):e.add({title:"Download failed",description:"No data to download",color:"warning"})}}]},{label:"Guidelines",icon:"i-lucide-book-check",to:{name:"guidelines"}},{label:"Activity logs",icon:"i-lucide-logs",to:{name:"activiy-user"}}]]),s=k([[{label:"Dashboard",icon:"i-lucide-layout-dashboard",to:{name:"admin"}},{label:"User",icon:"i-lucide-user-round-cog",to:{name:"users"}},{label:"Admin",icon:"i-lucide-shield-user",to:{name:"admin-list"}},{label:"Readings",icon:"i-lucide-chart-line",children:[{label:"Historical",icon:"i-lucide-chart-line",to:{name:"historical-admin"}},{label:"Z-score",icon:"i-lucide-chart-line",to:{name:"z-score-admin"}}]},{label:"User alert",icon:"i-lucide-siren",to:{name:"users-alerts"}},{label:"Guidelines",icon:"i-lucide-book-check",to:{name:"guidelines"}},{label:"Activity logs",icon:"i-lucide-logs",to:{name:"Activity-logs"}}]]);return(n,b)=>{const c=H,r=L,m=C;return w(),R(G,null,[x(m,{class:"lg:hidden flex flex-col gap-2 sticky top-0 w-full shadow-sm bg-white dark:bg-gray-900"},{content:A(()=>[u(a)?(w(),v(r,{key:0,orientation:"vertical",items:u(a).role==="general"?l.value:s.value,class:"data-[orientation=vertical]:w-full lg:hidden flex py-4 bg-white dark:bg-gray-900"},null,8,["items"])):S("",!0)]),default:A(()=>[x(c,{label:"On this page",class:"bg-white dark:bg-gray-900 shadow-sm",color:"neutral",variant:"subtle","trailing-icon":"i-lucide-chevron-down",block:""})]),_:1}),u(a)?(w(),v(r,{key:0,orientation:"vertical",items:u(a).role==="general"?l.value:s.value,class:"data-[orientation=vertical]:w-full lg:flex hidden"},null,8,["items"])):S("",!0)],64)}}}),j=i=>{const a="http://localhost:8000/api/";let e="";return a.includes("https")?e=a.replace("https://",""):e=a.replace("http://",""),new WebSocket(`ws://${e}auth/ws/${i}`)};export{Y as _,B as a,W as g,j as s};
