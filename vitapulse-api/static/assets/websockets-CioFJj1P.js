import{m as C,n as L}from"./HeadUlo.vue_vue_type_script_setup_true_lang-C-qicoL-.js";import{p as y,g as N,q as T,u as U,r as x,c as R,F as G,b as k,h as v,k as S,w as A,m as u,e as H,o as w}from"./index-CHud2kZi.js";import{E as M}from"./jspdf.es.min-B249Tpl9.js";const W=s=>{const a=new Date(s);return new Date().getFullYear()-a.getFullYear()},B=async(s,a)=>{const t=new M;let i=[],l;try{const{data:n}=await y.get(`/auth/user/${a}`);l=n;const{data:b}=await y.get(`/auth/bp/summary/${a}?filter=${s}`);if(i=b,!i||i.length<0)return null;t.setFontSize(20),t.text("Health Summary Report",20,20);const c=i.reduce((e,o)=>(e.systolic+=o.systolic,e.diastolic+=o.diastolic,e),{systolic:0,diastolic:0}),r=(c.systolic/i.length).toFixed(0),m=(c.diastolic/i.length).toFixed(0),P=(i.reduce((e,o)=>(e.pulse+=o.pulse,e),{pulse:0}).pulse/i.length).toFixed(0),g=i.reduce((e,o)=>o.systolic>e.systolic||o.systolic===e.systolic&&o.diastolic>e.diastolic?o:e),p=i.reduce((e,o)=>o.systolic<e.systolic||o.systolic===e.systolic&&o.diastolic<e.diastolic?o:e),f=i.reduce((e,o)=>o.pulse>e.pulse?o:e),$=i.reduce((e,o)=>o.pulse<e.pulse?o:e),h=i.map(e=>new Date(e.timestamp)).sort((e,o)=>e.getTime()-o.getTime()),D=h[0],_=h[h.length-1],d=e=>e.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),F=W(String(l==null?void 0:l.birthday));return t.setFontSize(14),t.text(`Name: ${l.name}`,20,40),t.text(`Age: ${F}`,20,50),t.text(`Gender: ${l.sex}`,20,60),t.text(`Report Period: ${d(D)} to ${d(_)}`,20,70),t.text(`Generated on: ${new Date(Date.now()).toLocaleDateString()}`,20,80),t.text("Metric | Value",20,100),t.text("-----------------------------------",20,110),t.text(`Average BP: ${r}/${m}`,20,120),t.text(`Average Pulse: ${P} bpm`,20,130),t.text(`Highest BP: ${g.systolic} / ${g.diastolic} on ${new Date(g.timestamp).toLocaleString()}`,20,140),t.text(`Lowest BP: ${p.systolic} / ${p.diastolic} on ${new Date(p.timestamp).toLocaleString()}`,20,150),t.text(`Highest Pulse : ${f.pulse} bpm on ${new Date(f.timestamp).toLocaleDateString()}`,20,160),t.text(`Lowest Pulse : ${$.pulse} bpm on ${new Date($.timestamp).toLocaleDateString()}`,20,170),t.text(`Days Monitored : from: ${d(D)} - to: ${d(_)}`,20,180),await y.post("/auth/user/logs",{activity:"Downloaded Weekly summary Health report"},{headers:{"Content-Type":"application/json"}}),t.save(`${l.name}_health_summary_report.pdf`),!0}catch(n){return console.log(n),!1}},Y=N({__name:"SideNav",setup(s){const{auth:a}=T(),t=U(),i=x([[{label:"Dashboard",icon:"i-lucide-layout-dashboard",to:{name:"dashboard"}},{label:"Analytics",icon:"i-lucide-chart-bar",children:[{label:"Anomaly Detection",icon:"i-lucide-chart-line",to:{name:"anomaly"}}]},{label:"Alerts",icon:"i-lucide-siren",to:{name:"alerts"}},{label:"Summary health report",icon:"i-lucide-file-text",children:[{label:"Weekly report",icon:"i-lucide-arrow-down-from-line",onClick:async()=>{if(!a)return;await B("weekly",a==null?void 0:a.id)?t.add({title:"Download success",description:"Weekly health report",color:"success"}):t.add({title:"Download failed",description:"No data to download",color:"warning"})}},{label:"Monthly report",icon:"i-lucide-arrow-down-from-line",onClick:async()=>{if(!a)return;await B("monthly",a==null?void 0:a.id)?t.add({title:"Download success",description:"Monthly health report",color:"success"}):t.add({title:"Download failed",description:"No data to download",color:"warning"})}}]},{label:"Guidelines",icon:"i-lucide-book-check",to:{name:"guidelines"}},{label:"Activity logs",icon:"i-lucide-logs",to:{name:"activiy-user"}}]]),l=x([[{label:"Dashboard",icon:"i-lucide-layout-dashboard",to:{name:"admin"}},{label:"User",icon:"i-lucide-user-round-cog",to:{name:"users"}},{label:"Admin",icon:"i-lucide-shield-user",to:{name:"admin-list"}},{label:"Readings",icon:"i-lucide-chart-line",children:[{label:"Historical",icon:"i-lucide-chart-line",to:{name:"historical-admin"}},{label:"Z-score",icon:"i-lucide-chart-line",to:{name:"z-score-admin"}}]},{label:"User alert",icon:"i-lucide-siren",to:{name:"users-alerts"}},{label:"Guidelines",icon:"i-lucide-book-check",to:{name:"guidelines"}},{label:"Activity logs",icon:"i-lucide-logs",to:{name:"Activity-logs"}}]]);return(n,b)=>{const c=H,r=L,m=C;return w(),R(G,null,[k(m,{class:"lg:hidden flex flex-col gap-2 sticky top-0 w-full shadow-sm bg-white dark:bg-gray-900"},{content:A(()=>[u(a)?(w(),v(r,{key:0,orientation:"vertical",items:u(a).role==="general"?i.value:l.value,class:"data-[orientation=vertical]:w-full lg:hidden flex py-4 bg-white dark:bg-gray-900"},null,8,["items"])):S("",!0)]),default:A(()=>[k(c,{label:"On this page",class:"bg-white dark:bg-gray-900 shadow-sm",color:"neutral",variant:"subtle","trailing-icon":"i-lucide-chevron-down",block:""})]),_:1}),u(a)?(w(),v(r,{key:0,orientation:"vertical",items:u(a).role==="general"?i.value:l.value,class:"data-[orientation=vertical]:w-full lg:flex hidden"},null,8,["items"])):S("",!0)],64)}}}),j=s=>new WebSocket(`ws://localhost:8888/api/auth/ws/${s}`);export{Y as _,B as a,W as g,j as s};
